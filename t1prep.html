<!DOCTYPE html>
<!-- saved from url=(0036)https://braingps.mricloud.org/t1prep -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
<!--     https://braingps.mricloud.org -->
    <title>迈格云平台 | T1多图谱分割</title>

    
    <link rel="shortcut icon" href="https://braingps.mricloud.org/img/favicon.ico">
    <!-- 20131205 to make the boostrap-styled components like dropdown menus working must include the boostrap.js, 
    and must include jquery before boostrap.js !!!!! -->
<!--     <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js" type="text/javascript"></script> -->
    <!-- point jquery source to local position, in case the googleapis.com link doesn't work -->
    <script src="jquery/1.9.1/jquery.min.js" type="text/javascript"></script>
    <!-- use HTML::script() function to add script file, thus will generate absolute path!!! -->
    
<!--     <script src="bootstrap/js/bootstrap.min.js" type="text/javascript"></script> -->
<!--     <link media="all" type="text/css" rel="stylesheet" href="https://braingps.mricloud.org/fontawesome/font-awesome.min.css">
 -->
    
<!--    <script src="https://braingps.mricloud.org/bootstrap/js/bootstrap.min.js"></script>
 modify the .modal classes to enable .modal-lg etc    
    <link media="all" type="text/css" rel="stylesheet" href="https://braingps.mricloud.org/bootstrap/css/bootstrap.css">
 
    <link media="all" type="text/css" rel="stylesheet" href="https://braingps.mricloud.org/bootstrap/css/bootstrap-responsive.css">
 --> 

<!-- new version bootstrap is not compatible with 20140821 page code  
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
    <link media="all" type="text/css" rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
 
    <link media="all" type="text/css" rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap-theme.min.css">
 
    --> 

    
    <script src="jquery/1.9.1/bootstrap.min.js"></script>
    <link media="all" type="text/css" rel="stylesheet" href="css/bootstrap.min.css">
 
<!-- this theme css change the style!!!!!!!11  
  <link media="all" type="text/css" rel="stylesheet" href="https://braingps.mricloud.org/bootstrap/bootstrap-3.2.0/dist/css/bootstrap-theme.min.css">
 --> 
    
<!--    <link media="all" type="text/css" rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
     <link media="all" type="text/css" rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap-theme.min.css">
 
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
-->
    
    <link media="all" type="text/css" rel="stylesheet" href="css/font-awesome.css">
    <link media="all" type="text/css" rel="stylesheet" href="css/style.css">
<!-- 
    <link media="all" type="text/css" rel="stylesheet" href="https://braingps.mricloud.org/bootstrap/3.0.3/css/bootstrap.css">
    <link media="all" type="text/css" rel="stylesheet" href="https://braingps.mricloud.org/bootstrap/3.0.3/css/bootstrap.min.css">
    <link media="all" type="text/css" rel="stylesheet" href="https://braingps.mricloud.org/bootstrap/3.0.3/css/bootstrap-theme.css">
    <link media="all" type="text/css" rel="stylesheet" href="https://braingps.mricloud.org/bootstrap/3.0.3/css/bootstrap-theme.min.css">
     <link media="all" type="text/css" rel="stylesheet" href="https://braingps.mricloud.org/css/style.css">
 -->   <link rel="stylesheet" href="css/jquery.fileupload-ui.css">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
<link type="text/css" href="./addfiles/sliders.css" rel="stylesheet">
		<link type="text/css" href="./addfiles/elian.css" rel="stylesheet">
		<link type="text/css" href="./addfiles/mycss.css" rel="stylesheet">
		<link type="text/css" href="./addfiles/bootstrap.min.css" rel="stylesheet">
		<script type="text/javascript" src="./addfiles/swiper-3.3.1.min.js"></script>
		<link rel="stylesheet" href="./addfiles/swiper-3.3.1.min.css">
		<script src="./addfiles/jquery.min.js"></script>
		<script src="./addfiles/bootstrap.min.js"></script>
		<script src="bootstrap/bootstrap-3.2.0/dist/js/bootstrap.min.js"></script>
  </head>
  <body>
		        <div class="container">
        <div class="navbar navbar-default">
             <div class="container-fluid"> 
            

<!--               <div class="collapse nav-collapse"> -->
<!-- -->
            <ul class="nav navbar-nav">
			<!-- UrlHelper::get_active("home") will return whether the button will appear active according to the path name -->
			<!-- HTML::link('home','Home') first argument is path, second argument is the displayed string of the button -->
            <li class=""><a href="BrainGPSindex">主页</a></li>
			<li class="dropdown">
 	         <a href="https://braingps.mricloud.org/t1prep" class="dropdown-toggle" data-toggle="dropdown">手册<b class="caret"></b></a> 
	        	<ul class="dropdown-menu">
	            <li><a href="tutorial.html">T1-多图谱分割</a></li>
	           	<li><a href="https://braingps.mricloud.org/docs/MriCloudRelease_DTI.pdf">DTI Calculation</a></li>
	            </ul>
			</li>
<!--         <li class=""><a href="datasources.html">数据来源</a></li>
             <li class=""><a href="https://braingps.mricloud.org/processingservers">Processing Servers</a></li>
              <li class=""><a href="https://braingps.mricloud.org/lddmm">LDDMM</a></li>
              <li class=""><a href="https://braingps.mricloud.org/t1seg">T1Seg</a></li>
              <li class=""><a href="https://braingps.mricloud.org/roivis">ROIVis</a></li>
              <li class=""><a href="myjobstatus.html">我的工作状态</a></li>
-->               
				<li class="dropdown">
 		         <a href="https://braingps.mricloud.org/t1prep" class="dropdown-toggle" data-toggle="dropdown">T1图像多图谱分割<b class="caret"></b></a> 
		        	<ul class="dropdown-menu">
<!-- 	              <li class=""><a href="https://braingps.mricloud.org/lddmm">LDDMM</a></li> -->
		        
<!--              <li class="active"><a href="https://braingps.mricloud.org/t1prep">T1-Brain/Skull/CSF/Ventricle</a></li> -->
	              <li class="active"><a href="t1prep.html">T1-多图谱分割</a></li>
<!--              <li class=""><a href="https://braingps.mricloud.org/t1seg">T1-250</a></li> -->
		    	  <li class=""><a href="t1batch.html">T1-多图谱分割批处理</a></li>
	              		    	              </ul>
		      </li>
				<li class="dropdown">
 		         <a href="https://braingps.mricloud.org/t1prep" class="dropdown-toggle" data-toggle="dropdown">DTI<b class="caret"></b></a> 
		        	<ul class="dropdown-menu">
		      	      <li class=""><a href="dtical.html">DTI 参数计算</a></li>
		      	      <li class=""><a href="dtimultiatlasseg.html">DTI 多图谱分割</a></li>
		      	      </ul>
      	      </li>
	      	  <li class=""><a href="fmri.html">FMRI</a></li> 	              
	      	  <li class=""><a href="asl.html">ASL</a></li> 	              
      	      		          	       	              
      	      <li class="dropdown">
 		         <a href="https://braingps.mricloud.org/t1prep" class="dropdown-toggle" data-toggle="dropdown">表面绘制<b class="caret"></b></a> 
	        	<ul class="dropdown-menu">
              	<li class=""><a href="ste.html">从人群中建立表面模板</a></li> 	              
              	<li class=""><a href="surfacelddmm.html">将表面模板映射到人群中</a></li> 	              
<!--               	<li class=""><a href="https://braingps.mricloud.org/ste">STE</a></li> 	              
              	<li class=""><a href="https://braingps.mricloud.org/surfacelddmm">surface LDDMM</a></li> --> 	              
              	</ul>
		      </li>
<!-- 	          <li class=""><a href="https://braingps.mricloud.org/roivis">ROIVis</a></li>-->
	          <li class=""><a href="myjobstatus.html">我的工作状态</a></li>
	          <li class=""><a href="atlasrepo.html">图谱信息</a></li>	          
		      <li class=""><a href="profile.html">我的个人信息</a></li>
		    		                <li class=""><a href="https://braingps.mricloud.org/logout">登出</a></li>					          
		      
        
              </ul>
          </div><!--/.nav-collapse -->
      </div>
      </div>

   <div class="container" style="margin-top:100px">
    <div class="nav navbar-default">

        
<h3>T1 多图谱分割 <a style="display: inline" href="https://braingps.mricloud.org/t1prep#footnote"><i class="icon-info-sign" id="foottip" data-hasqtip="0"></i></a>
		<div id="footnote" style="display:none">
		<h4>T1 MultiAtlas Segmentation</h4>

			<p><u>Overview:</u> The T1 MultiAtlas Segmentation by DiffeoMaps offers the high throughput Software as a Service for processing T1 (MPRAGE) images and converting them into 286 segmented structures based on the brain Ontology of the JHU multi-atlas inventories. The pipeline uses an atlas based approach, deforming a set of atlases to your brain data, and applying the deformations to a corresponding set of segmentations. It then performs likelihood fusion across the set of segmentations, resulting in the segmentation of your data
			.<br>
			<u>Algorithm:</u> The MAP segmentation algorithm implemented I in the SaaS is the Multi-Atlas Likelihood Fusion (MALF) Algorithm delivering MAP reconstruction of the 286 segmented structures via likelihood fusion of the multiple segmented atlases defined under the JHU ontology described in Bayesian Parameter Estimation and Segmentation in the Multi-Atlas Random Orbit Model of Tang, Oishi, Faria, Hillis, Albert, Miller, PLOS One;2013http://www.plosone.org/article/info%3Adoi%2F10.1371%2Fjournal.pone.0065591,.<br>
			
			1) Image File Format : The Analyze 7.5 file format<br>
			2) Image Orientation: Axial (transverse) unflipped orientation (orient=0 in *.hdr file). Sagittal images will be automatically converted to axial images but needs to be so specified in the “Slice Type” section.<br>
			3) Image Data Format:<br>
			i) Unsigned character (8 bits per voxel)<br>
			ii) Signed short (16 bits per voxel) or<br>
			iii) Single floating point (32 bits per voxel)<br>
			</p>
			<p>
			<strong>Steps:</strong>
			1) Upload Image<br>
			i) Press the +Header push button to select your image .hdr file<br>
			ii)Press the +Image push button to select your image .img file<br>
			2) Select Processing Server<br>
			Use the "Select Processing Server" dropdown menu to select the server to be used<br>
			3) Select Atlas<br>
			Use the "Select Atlas" dropdown menu to seletc an atlas set. Atlas set descriptions can be found when the user selects an atlas set using the dropdown menu; the description should appear on the right side on blank white region. Larger atlases will in general require a larger time of computation.<br>
			4) Submit<br>
			Press "Submit" button to upload your data for processing.<br>
			5) Retrieve result<br>
			Use "My job Status" tab to check the status of the processing your data and download the result file when the processing is finished.<br>
			</p>
			<p>
			<strong>Outputs:</strong>
			1) Images:<br>
			A: User_defined_filename_.img/hdr: The submitted T1-weighted image that are converted to an axial image orientation, histogram matched, and intensity inhomogeneity corrected. The matrix size remains the original dimensions.<br>
			B: User_defined_filename_ss_.img/hdr: Same as A, except that the image is skull-stripped.<br>
			C: User_defined_filename_MNI.img/hdr: Same as A, except that the image is linearly normalized to the MNI space. The matrix size is 181x217x181 / 1 x 1 x 1 mm.<br>
			D: User_defined_filename_MNI_SS.img/hdr: Same as C, except that the image is skull-stripped.<br>
			2) Segmentation label files:<br>
			A: User_defined_filename_286labels.img/hdr: An ROI file that contains the 286 defined structures. <br>
			B: User_defined_filename_286labels_MNI.img/hdr: An ROI file that contains the 286 defined structures in the MNI space.<br>
			C: Multilevel_lookup_table.txt: This contains structure look-up table in a text format.<br>
			3) Volume report files:<br>
			A: User_defined_filename_286labels_stats.txt: The volumes (mm3) of all defined structures with 10 different granularity levels in the native patient coordinates.<br>
			B: User_defined_filename_286labels_corrected_stats.txt: Same as A, but the volumes are normalized using the total brain volume (= tissues + ventricles + sulci).<br>
			C: User_defined_filename_286labels_MNI_stats.txt: Same as A, but after the image normalization to the MNI coordinates by linear transformation.<br>
			</p>
<!-- old version
            <h4>T1 MultiAtlas Segmentation</h4>
            <p><strong>Overview:</strong> DiffeoMaps offers the high throughput Software as a Service for processing T1 images and converting them into 250  segmented structures based on the brain Ontology of the Mori family of atlases. Anatomyworks uses an atlas based approach, deforming a set of atlases to your brain, and applying the deformations to a corresponding set of segmentations.  Anatomyworks then performs label fusion across the set of segmentations, resulting in the segmentation of your image.</p>
            <p><strong>Algorithm: </strong>The MAP segmentation algorithm implemented I in the SaaS is the Multi-Atlas Likelihood Fusion Algorithm delivering MAP  reconstruction of the 250 segmented structures via likelihood fusion of the multiple segmented atlases defined under the Mori ontology described in Bayesian Parameter Estimation and Segmentation in the Multi-Atlas Random Orbit Model of Tang, Oishi, Faria, Hillis, Albert, Miller, PLOS One;2013http://www.plosone.org/article/info%3Adoi%2F10.1371%2Fjournal.pone.0065591,.</p>
            1)	Image File Format : The Analyze 7.5 file format<br>
            2)	Image Orientation: Axial (transverse) unflipped orientation (orient=0 in *.hdr file).<br>
            3)	Image Data Format:<br>
            i) Unsigned character (8 bits per voxel)<br>
            ii) Signed short (16 bits per voxel) or<br>
            iii) Single floating point (32 bits per voxel)<br>
            <p>
            Steps:<br>
            </p>
            1)	Upload Image<br>
            i) Press the +Header push button to select your image .hdr file<br>
            ii)Press the +Image push button to select your image .img file<br>
            2)	Select Processing Server<br>
            Use the "Select Processing Server" dropdown menu to select the server to be used<br>
            3)	Select Atlas<br>
            Use the "Select Atlas" dropdown menu to seletc an atlas set.  Atlas set descriptions can be found when the user selects an atlas set using the dropdown menu; the description should appear on the right side  on blank white region.  Larger atlases will in general require a larger time of computation.<br>
            4)	Submit<br>
            Press "Submit" button to upload your data for processing.<br>
            5)	Retrieve result<br>
            Use "My job Status" tab to check the status of the processing your data and download the result file  when the processing is finished.<br>
            <p>
            Outputs:<br>
            </p>
            1)	T1 multiatlas segmentation:<br>
            i) target.img/.hdr			T1 image (native coordinates)<br>
            ii) target_SS.img/.hdr		T1 image (skull stripped)<br>
            iii) target_MNI.img/.hdr		T1 image (MNI coordinates)<br>
            iv) target_MNI_SS.img/.hdr       	T1 image (skull stripped in MNI coordinates)<br>
            v) M1_lfseg_1.img/.hdr		label image-1 (native coordinates)<br>
            vi) M1_lfseg_1_MNI.img/.hdr	label image-1 (MNI coordinates)<br>
            vii) M1_lfseg_2.img/.hdr		label image-2 (native coordinates)<br>
            viii) M1_lfseg_2_MNI.img/.hdr	label image-2 (MNI coordinates)<br>

            ***Number of ROIs in each label image are different for each atlas set. label image-1 has 6 or 7 ROIs  for GM/WM/CSF/Ventricle/skull/ and background. label image-2 has more than 250 ROIs  showing different brain substructures.<br>

            2)	Skull stripped T1 multiatlas segmentation:<br>
            i) target.img/.hdr			T1 image (native coordinates)<br>
            ii) M2_lfseg_2.img/.hdr 		label image-1 (native space, calculated using likelihood fusion)<br>
            iii) M2_mvseg_2.img/.hdr 	label image-1 (native space, calculated using majority voting)<br>

            ***Number of ROIs in each label image are different for each atlas set. label image-2 have more than 250 ROIs  showing different brain substructures.<br>
 -->
        </div>
<!-- put all the content and behavior of the module in one place -->
<script src="jquery/1.9.1/jquery.qtip.min.js"></script>
<link rel="stylesheet" href="css/jquery.qtip.min.css">
	<script> 	
    // tooltip http://qtip2.com/demos
    $('#foottip').each(function() {
        $(this).qtip({
            content: {
//                text: $(this).next('.tooltiptext')
                  text: $('#footnote').html()
            },
            position: {
                target: 'mouse', // Position it where the click was...
                adjust: { mouse: false } // ...but don't follow the mouse
            }           
            
        });
    });   
</script></h4>		
	<p>首次使用迈格云平台？请看 <a href="https://braingps.mricloud.org/docs/tutorials/mricloud.html" target="_blank">手册</a>.</p>

<form method="POST" action="https://braingps.mricloud.org/t1prep" accept-charset="UTF-8" class="form-horizontal" id="fileupload"><input name="_token" type="hidden" value="PEj7qZXOVxvHQDDF9TIPTlpKeIEBnt6zhRKeelU3">
	<!-- as the bootstrap changes the classname will change -->	
	<div> <p><strong>请注意</strong>：因为存储空间限制，您的处理结果将会在任务提交后的60天删除，请及时下载您的处理结果。 
</p></div>	<!--	<div>
	If your images are in DICOM format, please first convert them to Analyze format.
	Click <a href="tools/Dcm2Analyze.exe" >here</a> to download a conversion tool for Windows OS						
	</div>
	--> 		
<div><p>

All visualization in MriCloud follows the Radiology convention: 
the image left is the patient right. We are aware of inconsistency in the definitions of 
image orientations in DICOM, Analyze, and other file types. We guarantee the right-left 
orientation ONLY WHEN the raw DICOM files FROM scanners (not from PACS and other data 
archiving systems) are converted to the Analyze format using the programs we offer. 
According to your operating systems and DICOM formats, 
download the program for <a href="https://braingps.mricloud.org/tools/Dcm2Analyze_v3.exe">WindowsOS</a> or <a href="https://braingps.mricloud.org/tools/Dcm2Analyze_v3.dmg">MacOS</a>. 

If the data are exported from other software or the images are touched by external software 
during the preparation, the users have the responsibility to identify the right-left orientation, 
regardless of our labeling. This can be done by inspecting the images in our output files and 
compare them with another visualization program you trust, preferably the scanner vendors’ console or 
workstations.</p>
</div>	<!-- put form and picture side by side 
	http://stackoverflow.com/questions/14148134/how-to-position-three-div-elements-side-by-side-across-a-webpage -->	
    <!-- The fileinput-button span is used to style the file input field as button -->
    <p>To start over, refresh the page</p>
    <table style="width:100%">
    	<tbody><tr>
			<td width="50%">
    <p><strong>上传您解析格式(Analyze)的文件</strong></p>
    <span class="btn btn-success fileinput-button">
        <i class="icon-plus icon-white"></i>
        <span>头文件(.hdr)</span>
        <input type="file" name="target_hdr">
    </span>
    <span class="btn btn-success fileinput-button">
        <i class="icon-plus icon-white"></i>
        <span>图像文件(.img)</span>
        <input type="file" name="target_img">
    </span>
    <br>
    <br>
    <p><strong>文件选择</strong></p>
    
    <br>
    <div id="files" class="files"></div>
    <p class="subheading">可选信息</p>    
    <!-- if you make it a button in bootstrap will triger a submit action, use anchor not button to avoid it
http://stackoverflow.com/questions/9281179/how-to-cancel-form-submit-for-btn-primary-within-form-actions-of-twitter-bootstr -->
<a class="btn btn-primary" data-toggle="modal" data-target="#DemoInfoModal">
 		个体信息
</a>

<!-- <p><strong>Input demographics information of subject</strong></p> -->

<!-- <p class="subheading">Age:</p>
   <input type="number" name="age">
    <p class="subheading">Gender:</p>
     <select name="gender" id="gender" class="form-control span3">
           <option value="Male">Male</option>
           <option value="Female">Female</option>
     </select>
 -->     
<!-- refer to http://getbootstrap.com/javascript/ --> 
<!-- user can opt-out clinical information submission, so put a hidden field -->
<!-- <input name="SubmitClinicalInfo" id="boolclinic" type="hidden" value="false">  -->
<div class="modal fade" id="DemoInfoModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" display="none">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
<!--    <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button> -->
        <h4 class="modal-title" id="myModalLabel">个体信息</h4>
      </div>
      <div id="demo_form_body" class="modal-body">
<!--    -->   	<p class="subheading">年龄:</p>
   		<input type="number" name="age" class="form-control span3">
    	<p class="subheading">性别：</p>
     	<select name="gender" id="gender" class="form-control span3">
           <option value="Male">男</option>
           <option value="Female">女</option>
     	</select>
   		惯用手： 
   		<!-- in this name you can make sub-array of submitted variables -->
	    <select name="handedness" id="clinical_handedness" class="form-control span3">
	           <option value="Unknown">未知</option>
	           <option value="Right">右手</option>
	           <option value="Left">左手</option>
	    </select>
   		肤色：
   		<!-- in this name you can make sub-array of submitted variables -->
	    <select name="race" id="clinical_handedness" class="form-control span3">
	           <option value="Unknown">未知</option>
	           <option value="White">白种人</option>
	           <option value="Black">黑种人</option>
	           <option value="Asian">黄种人</option>
	    </select>
	    
	    
     
      	</div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" id="democancel" data-dismiss="modal">Cancel Saving</button>
        <button type="button" class="btn btn-primary" id="demosave" data-dismiss="modal">Save changes</button>
      </div>
    </div>
  </div>
</div>	<br>    
    <br>    
<!-- -->     		<!-- refer to http://getbootstrap.com/javascript/ -->
<!-- v3 for icd10, my own code for dyanmic select menu update -->
<!-- if you make it a button in bootstrap will triger a submit action, use anchor not button to avoid it 
http://stackoverflow.com/questions/9281179/how-to-cancel-form-submit-for-btn-primary-within-form-actions-of-twitter-bootstr --> 
<a class="btn btn-primary" data-toggle="modal" data-target="#ClinicalInfoModal">
 		临床诊断 
</a>
<!-- user can opt-out clinical information submission, so put a hidden field -->
<input name="SubmitClinicalInfo" id="boolclinic" type="hidden" value="false">
<input name="number_of_diagnosis" id="n_Diagnosis" type="hidden" value="0">
<div class="modal fade" id="ClinicalInfoModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
<!-- this is how to get a large modal http://codepen.io/SitePoint/pen/KkHyw -->
  <div class="modal-dialog modal-lg">
  
    <div class="modal-content">
      <div class="modal-header">
<!--    <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button> -->
        <h4 class="modal-title" id="myModalLabel">ICD10 临床诊断信息</h4>
      </div>
       <div id="clinical_form_body" class="modal-body" form_list_id="clinical_form_list"> 
  		<div id="form_controls">增加一个临床信息诊断结果<button type="button">+</button> 去除一个临床信息诊断结果<button type="button">-</button></div><div id="clinical_form_list"><div form_index="0"><legend>Diagnosis 1</legend><div form_index="0"><div form_index="0"><div>Category Level 1</div><input name="diagnosis_form[0][category][level_0]" id="diagnosis_form_0_category_level_0_full_name" type="hidden" value="0: not selected"><select full_name_value_id="diagnosis_form_0_category_level_0_full_name"><option value="0">0: not selected</option><option value="I">I: Certain infectious and parasitic diseases</option><option value="II">II: Neoplasms</option><option value="III">III: Diseases of the blood and blood-forming organs and certain disorders involving the immune mechanism</option><option value="IV">IV: Endocrine, nutritional and metabolic diseases</option><option value="V">V: Mental and behavioural disorders</option><option value="VI">VI: Diseases of the nervous system</option><option value="VII">VII: Diseases of the eye and adnexa</option><option value="VIII">VIII: Diseases of the ear and mastoid process</option><option value="IX">IX: Diseases of the circulatory system</option><option value="X">X: Diseases of the respiratory system</option><option value="XI">XI: Diseases of the digestive system</option><option value="XII">XII: Diseases of the skin and subcutaneous tissue</option><option value="XIII">XIII: Diseases of the musculoskeletal system and connective tissue</option><option value="XIV">XIV: Diseases of the genitourinary system</option><option value="XV">XV: Pregnancy, childbirth and the puerperium</option><option value="XVI">XVI: Certain conditions originating in the perinatal period</option><option value="XVII">XVII: Congenital malformations, deformations and chromosomal abnormalities</option><option value="XVIII">XVIII: Symptoms, signs and abnormal clinical and laboratory findings, not elsewhere classified</option><option value="XIX">XIX: Injury, poisoning and certain other consequences of external causes</option><option value="XX">XX: External causes of morbidity and mortality</option><option value="XXI">XXI: Factors influencing health status and contact with health services</option><option value="XXII">XXII: Codes for special purposes</option></select></div></div><div><div>Probability</div><select name="diagnosis_form[0][probability]"><option value="Definitely">Definitely</option><option value="Probably">Probably</option><option value="Possibly">Possibly</option></select></div></div></div></div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" id="clinicalcancel" data-dismiss="modal">取消</button>
        <button type="button" class="btn btn-primary" id="clinicalsave" data-dismiss="modal">保存</button>
      </div>
    </div>
  </div>
</div>

<!-- should have jquery source included in the parent document -->	<br>    
    <br>    
      		 <!-- refer to http://getbootstrap.com/javascript/ --> 
<a class="btn btn-primary" data-toggle="modal" data-target="#RadInfoModal">
 		成像信息
</a>
<!-- user can opt-out clinical information submission, so put a hidden field -->
<input name="SubmitRadiologyInfo" id="boolrad" type="hidden" value="false">
<div class="modal fade" id="RadInfoModal" tabindex="-1" role="dialog" aria-labelledby="myRadModalLabel" aria-hidden="true">
<!-- this is how to get a large modal http://codepen.io/SitePoint/pen/KkHyw -->
  <div class="modal-dialog modal-lg">
  
    <div class="modal-content">
      <div class="modal-header">
<!--    <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button> -->
        <h4 class="modal-title" id="myRadModalLabel">成像信息</h4>
      </div>
      	检查是否满足于：
       <div id="rad_form_body" class="modal-body"><ul class="dynatree-container"><li class=""><span class="dynatree-node dynatree-folder dynatree-has-children dynatree-exp-c dynatree-ico-cf"><span class="dynatree-expander"></span><span class="dynatree-checkbox"></span><span class="dynatree-icon"></span><a href="https://braingps.mricloud.org/t1prep#" class="dynatree-title">Temporal Descriptor</a></span></li><li class=""><span class="dynatree-node dynatree-folder dynatree-has-children dynatree-exp-c dynatree-ico-cf"><span class="dynatree-expander"></span><span class="dynatree-checkbox"></span><span class="dynatree-icon"></span><a href="https://braingps.mricloud.org/t1prep#" class="dynatree-title">Location</a></span></li><li class=""><span class="dynatree-node dynatree-folder dynatree-has-children dynatree-exp-c dynatree-ico-cf"><span class="dynatree-expander"></span><span class="dynatree-checkbox"></span><span class="dynatree-icon"></span><a href="https://braingps.mricloud.org/t1prep#" class="dynatree-title">Parenchymal location</a></span></li><li class=""><span class="dynatree-node dynatree-folder dynatree-has-children dynatree-exp-c dynatree-ico-cf"><span class="dynatree-expander"></span><span class="dynatree-checkbox"></span><span class="dynatree-icon"></span><a href="https://braingps.mricloud.org/t1prep#" class="dynatree-title">Intensity</a></span></li><li class=""><span class="dynatree-node dynatree-folder dynatree-has-children dynatree-exp-c dynatree-ico-cf"><span class="dynatree-expander"></span><span class="dynatree-checkbox"></span><span class="dynatree-icon"></span><a href="https://braingps.mricloud.org/t1prep#" class="dynatree-title">Distribution Patter</a></span></li><li class=""><span class="dynatree-node dynatree-folder dynatree-has-children dynatree-exp-c dynatree-ico-cf"><span class="dynatree-expander"></span><span class="dynatree-checkbox"></span><span class="dynatree-icon"></span><a href="https://braingps.mricloud.org/t1prep#" class="dynatree-title">Other Findings</a></span></li><li class=""><span class="dynatree-node dynatree-folder dynatree-has-children dynatree-exp-c dynatree-ico-cf"><span class="dynatree-expander"></span><span class="dynatree-checkbox"></span><span class="dynatree-icon"></span><a href="https://braingps.mricloud.org/t1prep#" class="dynatree-title">Co-morbidity</a></span></li><li class="dynatree-lastsib"><span class="dynatree-node dynatree-folder dynatree-has-children dynatree-lastsib dynatree-exp-cl dynatree-ico-cf"><span class="dynatree-expander"></span><span class="dynatree-checkbox"></span><span class="dynatree-icon"></span><a href="https://braingps.mricloud.org/t1prep#" class="dynatree-title">medication</a></span></li></ul></div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" id="radcancel" data-dismiss="modal">取消</button>
        <button type="button" class="btn btn-primary" id="radsave" data-dismiss="modal">保存</button>
      </div>
    </div>
  </div>
</div>

<!-- should have jquery source included in the parent document -->  		 
     
	<br>    
	<br>
       <p class="subheading">选择处理服务器</p>
        <select name="processing_serverid" id="processing_serverid" class="form-control span5">
                          <option value="Gordon">Computational Anatomy Science Gateway</option>
                    </select>
        <p></p>
       <p class="subheading">Select Slice Type</p>
        <select name="slice_type" id="" slice_type""="" class="form-control span7">
                          <option value="1">Sagittal</option>
                          <option value="0">Axial</option>
                          <option value="2">Sagittal data converted to Axial</option>
                    </select>
        <br>
        <p class="subheading">Select Atlas *</p>
        <select name="atlas_name" id="atlas_name" class="form-control span7"> --&gt;
        <!-- elements without a name in a form will not be in submitted data
        <select id="atlas_name" class="form-control span7"> -->
                      <option value="0">Adult22_50yrs_289Labels_12atlases_marcctest</option>
                          <option value="1">Adult_286labels_10atlases_mV5L</option>
                          <option value="2">Pediatric_286labels_11atlases_mV5L</option>
                          <option value="3">Adult22_50yrs_289Labels_26atlases_M2_V7A  </option>
                          <option value="4">Adult50_90yrs_289Labels_19atlases_M2_V7A  </option>
                          <option value="5">Pediatric4-8yrs_289Labels_10atlases_M2_V7A</option>
                          <option value="6">Pediatric8-12yrs_289Labels_28atlases_M2_V7A</option>
                          <option value="7">Adult22_50yrs_283Labels_26atlases_M2_V9A</option>
                          <option value="8">Adult50_90yrs_283Labels_19atlases_M2_V9A</option>
                    </select>
        <br>
        <p> <span class="subheading">Description: </span> (e.g. AD_subject1)</p>
<input placeholder="write job description here" class="form-control span5" name="description" type="text" value="">    <!-- The global progress bar -->
    
        <p><strong>Progress</strong></p>
    <div id="progress" class="progress"><div class="progress-bar" role="progressbar" aria-valuemin="0" aria-valuemax="100"></div></div>

    <br>
    <button class="btn" id="pb">Submit</button>
    <br>
	    </td>
	    <td width="50%">
    <!-- <div style = "float: right; width: 50%;"> -->
    <p><img src="img/T1_pipeline_graphic_images.png" align="right" border="0" width="300"></p>    <!-- </div> -->
	</td>
    </tr>
    </tbody></table>    
    <!--	<div>
	If your images are in DICOM format, please first convert them to Analyze format.
	Click <a href="tools/Dcm2Analyze.exe" >here</a> to download a conversion tool for Windows OS						
	</div>
	--> 		
<div>
<br><br>
<p>
* The atlas name consists of "Age range" + "The number of defined structures" + "The number of atlases" + ("Fusion algorithm") + "Atlas version".
<br>
For the "Fusion algorithm" section indicates the following:
<br>
M1 or not specified: The fusion algorithm follows the method described by Tang et al (1).

<br>
M2: The final atlas-fusion step of this pipeline uses algorithms that was kindly provided by Drs. Hongzhi Wang and Paul Yushkevich 
(<a target="_blank" href="http://picsl.upenn.edu/people/faculty-staff/paul-yushkevich/">http://picsl.upenn.edu/people/faculty-staff/paul-yushkevich/</a>). The details of the algorithm can be found in a reference below (2).
<br>
<small>(1) Tang, X., K. Oishi, A. V. Faria, A. E. Hillis, M. S. Albert, S. Mori and M. I. Miller (2013). "Bayesian Parameter Estimation and Segmentation in the Multi-Atlas Random Orbit Model." PLOS ONE 8(6): e65591, 3688886
<br>
(2) Wang, H., A. Pouch, M. Takabe, B. Jackson, J. Gorman, R. Gorman and P. A. Yushkevich (2013). "Multi-atlas segmentation with robust label transfer and label fusion." Inf Process Med Imaging 23: 548-559, 3974208.
</small></p>
</div>

<script>var filetyperegex = /(\.|\/)(hdr|img)$/i ;</script>    
        
    </form></div>
    </div>

    <div class="container">
    <footer>
  		
    <div class="container text-center">
        <hr>
<p style="font-size:14px;font-family:微软雅黑">迈格云平台  <br> Site created by <a href="http://www.anatomyworks.com/">AnatomyWorks, LLC</a>. All Rights Reserved 2016 
<a href="https://braingps.mricloud.org/t1prep#mricloud_tip"><i class="icon-info-sign" id="mricloudtip" data-hasqtip="1"></i></a>
		</p><div id="mricloud_tip" style="display:none">
		<p>	MriCloud 1.0</p>
		<p>Copyright 2013 AnatomyWorks LLC, <a href="https://www.anatomyworks.com/">www.anatomyworks.com</a>
</p><p>This website was created by AnatomyWorks. BrainGPS algorithms and brain atlas resources are licensed from Johns Hopkins University.</p>
<p>MriCloud is not intended for clinical use and should be used for research purpose only.</p>
        </div>
<!-- put all the content and behavior of the module in one place -->
        
<script src="jquery/1.9.1/jquery.qtip.min.js"></script>
<link rel="stylesheet" href="css/jquery.qtip.min.css">
	<script> 	
    // tooltip http://qtip2.com/demos
    $('#mricloudtip').each(function() {
        $(this).qtip({
            content: {
//                text: $(this).next('.tooltiptext')
                  text: $('#mricloud_tip').html()
            },
            position: {
                target: 'mouse', // Position it where the click was...
                adjust: { mouse: false } // ...but don't follow the mouse
            }           
            
        });
    });   
</script><p></p>
<!--  <a href="#" data-toggle="tooltip" title="MRICloud  DiffeoMap 1.0
Copyright 2013 AnatomyWorks Inc., www.AnatomyWorks.com
MRICloud DiffeoMap is based on the AnatomyWorks patented DiffeoMAP GPS image analysis technologies for medical imaging and atlas based semantic representation of dense medical imagery. It enables any researcher working in the field of Computational Anatomy in Medical imaging to parse MR imagery into an ontological labeling based on parcellated atlas fields provided by researchers at Johns Hopkins University Susumu Mori from the Department of Radiology in the School of Medicine and Michael Miller from the Center for Imaging Science in the Whiting School of Engineering.
The DIffeoMap solutions for segmentation and image analysis currently support a large number of disease and age matched atlases built with a common neuroscience ontology.
MRICloud DiffeoMAP is licensed for use for research purposes only.
MRICloud is not intended for clinical use, and makes no representation that it is a clinically approved medical device. Analysis result must not be used for any purpose other than research. Each licensed user is issued with a corresponding license agreement which is either accepted or declined during the initial use of the software. If declined, the user cannot use MRICloud. 
If you have questions, please do not hesitate to contact us at …. or at info@MRICloud.org.
"><i class="icon-info-sign icon-large"></i></a>  		 
        <a class="nounderline" href="#" data-toggle="tooltip" title="GETTING STARTED
To enroll, if you are an MRIStudio user then the system will recognize you. If you are a new user with a Gmail account then MRICloud supports opened.
SEGMENTATION
MRICloud currently supports T1 and DTI segmentation.
T1-Brain/Skull/Ventricle/CSF provides a 4-5 label segmentation in native coordinates giving the user access to Brain (G+W) compartment, Skull compartment, Ventricle compartment, and CSF compartment. The service returns the following metadata in Native coordinates: … To use the service, select from the drop down SEGMENTATION button T1-Brain… Then select the dataset to be uploaded from either disk or an XNAT source. The status of your job will be in the Status section.
T1-250 provides a 250 label segmentation in native coordinates giving the user access to all such compartments. It’s use is the same as above.
DTI provides a …..
  		"><i class="icon-question-sign icon-large"></i></a>-->
        
        </div>
    </footer>
    </div>
    
    
<!-- <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>  -->
<script src="jquery/1.9.1/jquery.min.js" type="text/javascript"></script>
<script src="jquery/1.9.1/jquery.ui.widget.js"></script>
<script src="jquery/1.9.1/jquery.iframe-transport.js"></script>
<script src="jquery/1.9.1/jquery.fileupload.js"></script>
<script src="jquery/1.9.1/jquery.fileupload-process.js"></script>
<script src="jquery/1.9.1/jquery.fileupload-validate.js"></script>

<script>

var num_added = 0;
var added = 0;
var all_data = {};

function getName(Object, name) {
    return Object[name];
}
$(function () {
    'use strict';
        var uploadButton = $('<button/>')
            .addClass('btn')
            .prop('disabled', true)
            .text('Processing...')
            .on('click', function () {
                var $this = $(this),
                    data = $this.data();
                $this
                    .off('click')
                    .text('Abort')
                    .on('click', function () {
                        $this.remove();
                        data.abort();
                    });
                data.submit().always(function () {
                    $this.remove();
                });
            });
    $('#fileupload').fileupload({
        dataType: 'json', autoUpload: false,
        singleFileUploads: false,
        acceptFileTypes: filetyperegex,
        maxFileSize: 200000000, // 200 MB
        disableImageResize: true,
        // disable pasting file, pasting any string in the input box will trigger the fileuploadadd event handler, 
        pasteZone: null
    }).on('fileuploadadd', function (e, data) {
        data.context = $('#pb').text('Upload')
            .click(function () {
                data.context = $('<p/>').text('Uploading...').replaceAll($(this));
                data.submit();
            });
        data.context = $('<div/>').appendTo('#files');
        $.each(data.files, function (index, file) {
            var node = $('<p/>')
                    .append($('<span/>').text(file.name));
            if (!index) {
                node
                    .append('<br>');
                    <!--.append(uploadButton.clone(true).data(data));-->
            }
            node.appendTo(data.context);
        });
        num_added++;
    }).on('fileuploadprocessalways', function (e, data) {
        var index = data.index,
            file = data.files[index],
            node = $(data.context.children()[index]);
        if (file.preview) {
            node
                .prepend('<br>')
                .prepend(file.preview);
        }
        if (file.error) {
            node
                .append('<br>')
                .append(file.error);
        }
        if (index + 1 === data.files.length) {
            data.context.find('button')
                .text('Upload')
                .prop('disabled', !!data.files.error);
        }
    }).on('fileuploadprogressall', function (e, data) {
        var progress = parseInt(data.loaded / data.total * 100, 10);
//        $('#progress .bar').css( 'width', progress + '%');
        $('#progress .progress-bar').css( 'width', progress + '%');
        })
        .on('fileuploaddone', function (e, data) {
        data.context.text('Upload complete. Please check the status of your job at My Job Status');
        $.each(data.files, function (index, file) {
        //    alert(JSON.stringify(file));
            var link = $('<a>') .attr('target','_blank') .prop('href', file.url);
            $(data.context.children()[index]).wrap(link);
        });
    }).on('fileuploadsubmit', function (e, data) {
/* */   if(added < num_added)
        {
            if (added == 0)
            {
                all_data = data;
            }
            else
            {
                $.each(data['files'], function(i, file){
                    all_data['files'].push(file);
                });
                $.each(data['context'], function(i, context){
                    all_data['context'].push(context);
                });
                $.each(data['fileInput'], function(i, context){
                    all_data['fileInput'].push(context);
                });
                $.each(data['form'], function(i, context){
                    all_data['form'].push(context);
                });
                $.each(data['paramName'], function(i, context){
                    all_data['paramName'].push(context);
                });
            }
            added++;
            if (added == num_added)
            {
                added++;
                all_data.submit();
            }
            return false;
            
        }
    }).on('fileuploadsend', function (e, data) {
        num_added = 0; added = 0;
    }).on('fileuploadfail', function (e, data) {
        // display the error message in a message box
    	alert('Error: '+data._response.jqXHR.responseText+' Refresh the page to reupload.' );        
        $.each(data.files, function (index, file) {
            var error = $('<span/>').text(file.error);
            $(data.context.children()[index])
                .append('<br>')
                .append(error);
        });
    }).prop('disabled', !$.support.fileInput)
        .parent().addClass($.support.fileInput ? undefined : 'disabled');

    // progress bar should work with fileuploadprogressall function, it's for bootstrap 3.2.0
    $('#progress').addClass( "progress")
    .html('<div class="progress-bar" role="progressbar" aria-valuemin="0" aria-valuemax="100"></div>');
        

    
});
</script>
    <!-- have to yield the sections for javascript, the partial blades must put javascript include source files at the end!
    	if they are in the middle of the page, the libraries will not be loaded when calling jquery on document ready function!
    	the order the javascript source files loaded matters!!!!!!!
    	clinicalformjs must be load last to enable expandable feature!!!!!!!11
     --> 
    <!-- should have jquery source included in the parent document,
If you put this part of scripts in the middle of html documents,  
it seems these scripts are not loaded before 
the getJSON is called and the jsonForm function becomes undefined, 
so must put them in a separate section near the end of document -->
<!-- 	<script src="../jsonform-master/deps/jquery.min.js" type="text/javascript"></script> -->
    <script src="jquery/1.9.1/underscore.js" type="text/javascript"></script>
    <script src="jquery/1.9.1/jsonform_Yue.js" type="text/javascript"></script> 
<!--    <script src="../jsonform-master/lib/jsonform.js" type="text/javascript"></script> -->
    <script src="jquery/1.9.1/jsv.js" type="text/javascript"></script>	
<!--	<script src="demography_schema.js"></script> -->
    <style>
    
<!--  can't import    import url("../jsonform-master/deps/opt/bootstrap.css"); -->
	 .expandable > legend {
			background: transparent url('../jsonform-master/deps/img/rightArrow.gif') no-repeat scroll 0 center;
			cursor: pointer;
			padding-left: 20px;
			border-bottom: none;
		  }
		  .expanded > legend {
			background-image: url('../jsonform-master/deps/img/bottomArrow.gif');
			border-bottom: 1px solid #EEE;;
		  }
    </style>
<script>

$(function () {
	var jsonname = "../jsonforms/demography_schema.json";
//	var jsonname = "test.json";
//	var jsonname = "test_multilevel_choice.json";
	
	$.getJSON( jsonname, function( data ) {
		var $demoformbody = $("#demo_form_body"); 
//		$demoformbody.jsonForm(data);
	});

$('#clinicalcancel').click(function() {
	$('#boolclinic').val('false');
	});
$('#clinicalsave').click(function() {
	$('#boolclinic').val('true');
	});
});
</script>
    
<!-- should have jquery source included in the parent document,
If you put this part of scripts in the middle of html documents,  
it seems these scripts are not loaded before 
the getJSON is called and the jsonForm function becomes undefined, 
so must put them in a separate section near the end of document -->
<!--	<script src="../jsonform-master/deps/jquery.min.js" type="text/javascript"></script>
	<script src="dynatree-1.2.4/jquery/jquery.js" type="text/javascript"></script>
	<script src="../YueJS/dynatree-1.2.4/jquery/jquery-ui.custom.js" type="text/javascript"></script>-->
	<script src="jquery/1.9.1/jquery.cookie.js" type="text/javascript"></script>
	<link href="css/ui.dynatree.css" rel="stylesheet" type="text/css">
	<script src="jquery/1.9.1/jquery.dynatree.js" type="text/javascript"></script>
	<!-- Start_Exclude: This block is not part of the sample code 
	<link href="../YueJS/dynatree-1.2.4/doc/prettify.css" rel="stylesheet">
	<script src="../YueJS/dynatree-1.2.4/doc/prettify.js" type="text/javascript"></script>
	<link href="../YueJS/dynatree-1.2.4/doc/sample.css" rel="stylesheet" type="text/css">
	<script src="../YueJS/dynatree-1.2.4/doc/sample.js" type="text/javascript"></script>-->
<script>

$(function(){
	var jsonname = "../jsonforms/radiology_info_schema.json";
	$.getJSON( jsonname, function( data ) {
		console.log( "here?" );
			$("#rad_form_body").dynatree({
				checkbox: true,
				// Override class name for checkbox icon, so rasio buttons are displayed:
				//classNames: {checkbox: "dynatree-radio"},
				// Select mode 3: multi-hier
				selectMode: 3,
				children: data
			});
	});
});
</script>
    
<!-- 
    	the order the javascript source files loaded matters!!!!!!!
    	clinicalformjs must be load last to enable expandable feature!!!!!!!

should have jquery source included in the parent document,
If you put this part of scripts in the middle of html documents,  
it seems these scripts are not loaded before 
the getJSON is called and the jsonForm function becomes undefined, 
so must put them in a separate section near the end of document -->
<!-- 	<script src="../jsonform-master/deps/jquery.min.js" type="text/javascript"></script> -->
<!--    <script src="../jsonform-master/deps/underscore.js" type="text/javascript"></script>
     <script src="../jsonform-master/lib/jsonform_Yue.js" type="text/javascript"></script> -->
    <script src="jquery/1.9.1/clinical_form.js" type="text/javascript"></script> 
<!--    <script src="../jsonform-master/lib/jsonform.js" type="text/javascript"></script> -->
    <script src="jquery/1.9.1/jsv.js" type="text/javascript"></script>	
<!--	<script src="demography_schema.js"></script> -->
    <style>
	 .expandable > legend {
			background: transparent url('../jsonform-master/deps/img/rightArrow.gif') no-repeat scroll 0 center;
			cursor: pointer;
			padding-left: 20px;
			border-bottom: none;
		  }
		  .expanded > legend {
			background-image: url('../jsonform-master/deps/img/bottomArrow.gif');
			border-bottom: 1px solid #EEE;;
		  }
    </style>
<script>
var name_data = null;
var form_container = "clinical_form_body";

$(function () {
	var jsonname = "jsonforms/icd10_names.json";
//	var jsonname = "test.json";
//	var jsonname = "test_multilevel_choice.json";
	
	$.getJSON( jsonname, function( data ) {
		name_data = data;
		$('#'+form_container).initialize_diagnosis_form();
//		$('#'+form_container).add_one_diagnosis_form(data);
//		
	});
});
$('#clinicalcancel').click(function() {
	$('#n_Diagnosis').val($('#'+form_container).number_of_diagnosis_forms());
	$('#'+form_container).empty();
	$('#'+form_container).initialize_diagnosis_form();
//	$('#'+form_container).add_one_diagnosis_form(name_data);
//	initialize_diagnosis_form();
	$('#boolclinic').val('false');
});
$('#clinicalsave').click(function() {
	$('#boolclinic').val('true');
	// submit with the number of diagnosis
	$('#n_Diagnosis').val($('#'+form_container).number_of_diagnosis_forms());
});
</script>
        
  
</body></html>